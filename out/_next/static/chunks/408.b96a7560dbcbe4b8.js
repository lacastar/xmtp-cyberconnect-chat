(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[408],{200:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Te}});var r=t(59499),s=t(50029),i=t(71383),a=t(66690),c=t(87794),o=t.n(c),l=t(67294),d=t(53340),u=t(898);function f(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function x(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?f(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):f(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var m,h=function(){var e=(0,l.useReducer)((function(e,n){var t=n.peerAddress,s=n.messages,i=e[t]||[],a=s.filter(function(e){var n=e.map((function(e){return e.id}));return function(e){return-1===n.indexOf(e.id)}}(i));return a.length?(console.log("Dispatching new messages for peer address",t),x(x({},e),{},(0,r.Z)({},t,i.concat(a)))):e}),{}),n=e[0],t=e[1];return{getMessages:(0,l.useCallback)((function(e){return n[e]||[]}),[n]),dispatchMessages:t}},p=t(11491),v=t(28687),b=t(13828),g=t(49680),w=t.n(g),j=t(85893);function k(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function y(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?k(Object(t),!0).forEach((function(n){(0,r.Z)(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):k(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var N=new v.GraphQLClient(p.L),C=(0,v.gql)(m||(m=(0,i.Z)(["\n  query($address: String!, $first: Int) {\n    identity(address: $address) {\n      followings(first: $first) {\n        list {\n          address\n          domain\n        }\n      }\n      followers(first: $first) {\n        list {\n          address\n          domain\n        }\n      }\n    }\n  }\n"]))),A=function(e){var n=e.children,t=(0,l.useState)(),i=t[0],c=t[1],f=(0,l.useState)(),x=f[0],m=f[1],p=(0,l.useState)(),v=p[0],k=p[1],A=h(),Z=A.getMessages,O=A.dispatchMessages,T=(0,l.useState)(!1),P=T[0],S=T[1],E=(0,l.useState)({}),M=E[0],F=E[1],I=(0,l.useState)({}),D=I[0],R=I[1],L=(0,l.useReducer)((function(e,n){return void 0===n||void 0===(n=n.filter((function(n){return e.findIndex((function(e){return n.peerAddress===e.peerAddress}))<0&&n.peerAddress!=(null===v||void 0===v?void 0:v.address)})))?[]:e.concat(n)}),[]),_=L[0],H=L[1],K=(0,l.useCallback)(function(){var e=(0,s.Z)(o().mark((function e(n){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(n),e.next=3,n.getAddress();case 3:t=e.sent,m(t);case 5:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[c,m]),z=(0,l.useCallback)((0,s.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c(void 0),m(void 0),k(void 0),H(void 0),R({}),F({});case 6:case"end":return e.stop()}}),e)}))),[c,m,k,H]),$=(0,l.useCallback)(function(){var e=(0,s.Z)(o().mark((function e(n){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!n){e.next=12;break}if(t=new(w())({namespace:"CyberConnect",env:g.Env.PRODUCTION,chain:g.Blockchain.ETH,provider:window.ethereum}),!M[n.toLowerCase()]){e.next=9;break}return e.next=6,t.disconnect(n);case 6:F(y(y({},M),{},(0,r.Z)({},n.toLowerCase(),!1))),e.next=12;break;case 9:return e.next=11,t.connect(n);case 11:F(y(y({},M),{},(0,r.Z)({},n.toLowerCase(),!0)));case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error((0,b.e$)(e.t0));case 17:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(n){return e.apply(this,arguments)}}(),[M]),W=(0,l.useCallback)((0,s.Z)(o().mark((function e(){var n,t,r,s,i,a,c,l,d,u,f,m;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(d={},u={},f={address:x},m=null,!x){e.next=14;break}return e.prev=5,e.next=8,N.request(C,f);case 8:m=e.sent,e.next=14;break;case 11:e.prev=11,e.t0=e.catch(5),console.log((0,b.e$)(e.t0));case 14:d=null===(n=m)||void 0===n||null===(t=n.identity)||void 0===t||null===(r=t.followings)||void 0===r||null===(s=r.list)||void 0===s?void 0:s.reduce((function(e,n){return e[n.address.toLowerCase()]=!0,e}),{}),u=null===(i=m)||void 0===i||null===(a=i.identity)||void 0===a||null===(c=a.followers)||void 0===c||null===(l=c.list)||void 0===l?void 0:l.reduce((function(e,n){return e[n.address.toLowerCase()]=!0,e}),{}),F(d),R(u);case 18:case"end":return e.stop()}}),e,null,[[5,11]])}))),[x]);(0,l.useEffect)((function(){(function(){var e=(0,s.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=2;break}return e.abrupt("return");case 2:return e.t0=k,e.next=5,d.KU.create(i);case 5:e.t1=e.sent,(0,e.t0)(e.t1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[i]),(0,l.useEffect)((function(){(function(){var e=(0,s.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v){e.next=2;break}return e.abrupt("return");case 2:return console.log("Listing conversations"),S(!0),e.next=6,v.conversations.list();case 6:e.sent.forEach((function(e){H([e])})),S(!1);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}})()()}),[v,x]),(0,l.useEffect)((function(){(function(){var e=(0,s.Z)(o().mark((function e(){var n,t,r,s,i,c,l;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(v){e.next=2;break}return e.abrupt("return");case 2:n=v.conversations.stream(),t=!1,r=!1,e.prev=5,i=(0,a.Z)(n);case 7:return e.next=9,i.next();case 9:if(!(t=!(c=e.sent).done)){e.next=15;break}l=c.value,H([l]);case 12:t=!1,e.next=7;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(5),r=!0,s=e.t0;case 21:if(e.prev=21,e.prev=22,!t||null==i.return){e.next=26;break}return e.next=26,i.return();case 26:if(e.prev=26,!r){e.next=29;break}throw s;case 29:return e.finish(26);case 30:return e.finish(21);case 31:case"end":return e.stop()}}),e,null,[[5,17,21,31],[22,,26,30]])})));return function(){return e.apply(this,arguments)}})()()}),[v,x]),(0,l.useEffect)((function(){W()}),[W,x]);var q=(0,l.useState)({wallet:i,walletAddress:x,client:v,conversations:_,loadingConversations:P,getMessages:Z,dispatchMessages:O,connect:K,disconnect:z,followings:M,followers:D,toggleFollowing:$,getConnections:W}),X=q[0],U=q[1];return(0,l.useEffect)((function(){U({wallet:i,walletAddress:x,client:v,conversations:_,loadingConversations:P,getMessages:Z,dispatchMessages:O,connect:K,disconnect:z,followings:M,followers:D,toggleFollowing:$,getConnections:W})}),[i,x,v,_,P,Z,O,K,z,M,D,$,W]),(0,j.jsx)(u.E.Provider,{value:X,children:n})},Z=t(63800),O=t(11163),T=t(9008),P=t(41664),S=t(52016),E=t(56727),M=function(e){var n=e.children,t="/"===(0,O.useRouter)().pathname;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(E.uT.Root,{show:t,as:l.Fragment,children:(0,j.jsx)("div",{className:"fixed inset-0 flex bg-white md:hidden",children:(0,j.jsx)(E.uT.Child,{as:l.Fragment,enter:"transition ease-in-out duration-300 transform",enterFrom:"-translate-x-full",enterTo:"translate-x-0",leave:"transition ease-in-out duration-300 transform",leaveFrom:"translate-x-0",leaveTo:"-translate-x-full",children:(0,j.jsx)("div",{className:"relative flex-1 flex flex-col w-full bg-white",children:n})})})}),(0,j.jsx)("div",{className:"hidden md:flex",children:n})]})},F=function(e){var n=e.children,t="/"!==(0,O.useRouter)().pathname;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(E.uT.Root,{show:t,as:l.Fragment,children:(0,j.jsx)("div",{className:"md:hidden inset-0 flex flex-col h-screen bg-white ",children:(0,j.jsx)(E.uT.Child,{as:l.Fragment,enter:"transition ease-in-out duration-300 transform",enterFrom:"translate-x-full",enterTo:"translate-x-0",leave:"transition ease-in-out duration-300 transform",leaveFrom:"translate-x-0",leaveTo:"translate-x-full",children:(0,j.jsx)("div",{className:"md:hidden relative flex-1 flex flex-col w-full",children:n})})})}),(0,j.jsx)("div",{className:"hidden md:bg-white md:pl-84 md:flex md:flex-col md:flex-1 md:h-screen",children:n})]})},I=t(36655),D=function(){var e=(0,O.useRouter)(),n=(0,l.useCallback)((function(){e.push("/dm/")}),[e]);return(0,j.jsx)("button",{className:"inline-flex items-center h-7 md:h-6 px-4 py-1 my-4 bg-p-400 border border-p-300 hover:bg-p-300 focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-n-100 focus-visible:ring-offset-p-600 focus-visible:border-n-100 focus-visible:outline-none active:bg-p-500 active:border-p-500 active:ring-0 text-sm md:text-xs md:font-semibold tracking-wide text-white rounded",onClick:n,children:"+ New Message"})},R=t(77082),L=t(66293),_=t(4664),H=t(5712),K=t(92281),z=t(17406),$=t(32207),W=function(e){return e.length?e[e.length-1]:null},q=function(e){var n=e.conversation,t=e.isSelected,r=e.onClick,s=(0,S.Z)().lookupAddress,i=(0,z.Z)(n.peerAddress).messages,a=W(i),c="/dm/".concat(n.peerAddress);return a?(0,j.jsx)(P.default,{href:c,children:(0,j.jsx)("a",{onClick:r,children:(0,j.jsxs)("div",{className:(0,H.AK)("h-20","py-2","px-4","md:max-w-sm","mx-auto","bg-white","space-y-2","py-2","flex","items-center","space-y-0","space-x-4","border-b-2","border-gray-100","hover:bg-bt-100",t?"bg-bt-200":null),children:[(0,j.jsx)($.Z,{peerAddress:n.peerAddress}),(0,j.jsxs)("div",{className:"py-4 sm:text-left text w-full",children:[(0,j.jsxs)("div",{className:"grid-cols-2 grid",children:[(0,j.jsx)(K.Z,{address:n.peerAddress,className:"text-black text-lg md:text-md font-bold place-self-start",lookupAddress:s}),(0,j.jsx)("span",{className:(0,H.AK)("text-lg md:text-sm font-normal place-self-end",t?"text-n-500":"text-n-300"),children:(0,H.p6)(null===a||void 0===a?void 0:a.sent)})]}),(0,j.jsx)("p",{className:(0,H.AK)("text-[13px] md:text-sm font-normal text-ellipsis mt-0",t?"text-n-500":"text-n-300"),children:a&&(0,H.$G)(a.content,75)})]})]})})},n.peerAddress):null},X=function(e){var n=e.conversations,t=(0,O.useRouter)(),r=(0,l.useContext)(u.E).getMessages;return(0,j.jsx)("div",{children:n&&n.sort((function(e,n){var t,s,i=r(e.peerAddress),a=r(n.peerAddress);return((null===(t=W(i))||void 0===t?void 0:t.sent)||new Date)<((null===(s=W(a))||void 0===s?void 0:s.sent)||new Date)?1:-1})).map((function(e){var n=t.query.recipientWalletAddr==e.peerAddress;return(0,j.jsx)(q,{conversation:e,isSelected:n},e.peerAddress)}))})},U=t(30273),B=function(e){var n=e.children;return(0,j.jsxs)("div",{className:"flex flex-col flex-grow justify-center",children:[(0,j.jsxs)("div",{className:"flex flex-col items-center px-4 text-center",children:[(0,j.jsx)(R.Z,{className:"h-8 w-8 mb-1 stroke-n-200 md:stroke-n-300","aria-hidden":"true"}),(0,j.jsx)("p",{className:"text-xl md:text-lg text-n-200 md:text-n-300 font-bold",children:"No wallet connected"}),(0,j.jsx)("p",{className:"text-lx md:text-md text-n-200 font-normal",children:"Please connect a wallet to begin"})]}),n]})},G=function(e){var n=e.onConnect;return(0,j.jsx)("button",{onClick:n,className:"rounded border border-l-300 mx-auto my-4 text-l-300 hover:text-white hover:bg-l-400 hover:border-l-400 hover:fill-white focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-n-100 focus-visible:outline-none active:bg-l-500 active:border-l-500 active:text-l-100 active:ring-0",children:(0,j.jsxs)("div",{className:"flex items-center justify-center text-xs font-semibold px-4 py-1",children:["Connect your wallet",(0,j.jsx)(_.Z,{className:"h-4"})]})})},Q=function(e){var n=e.filter,t=e.followings,r=(0,Z.Z)(),s=r.conversations,i=r.loadingConversations;if(!r.client)return(0,j.jsx)(U.ZP,{headingText:"Awaiting signatures...",subHeadingText:"Use your wallet to sign",isLoading:!0});if(i)return(0,j.jsx)(U.ZP,{headingText:"Loading conversations...",subHeadingText:"Please wait a moment",isLoading:!0});var a=s;return t&&(n===p.w.Connected&&(a=s.filter((function(e){return t[e.peerAddress.toLowerCase()]}))),n===p.w.Invites&&(a=s.filter((function(e){return 1===e.messages.length&&!t[e.peerAddress.toLowerCase()]})))),a&&a.length>0?(0,j.jsx)("nav",{className:"flex-1 pb-4 space-y-1",children:(0,j.jsx)(X,{conversations:a})}):(0,j.jsx)(V,{})},V=function(){return(0,j.jsx)("div",{className:"flex flex-col flex-grow justify-center",children:(0,j.jsxs)("div",{className:"flex flex-col items-center px-4 text-center",children:[(0,j.jsx)(L.Z,{className:"h-8 w-8 mb-1 stroke-n-200 md:stroke-n-300","aria-hidden":"true"}),(0,j.jsx)("p",{className:"text-xl md:text-lg text-n-200 md:text-n-300 font-bold",children:"Your message list is empty"}),(0,j.jsx)("p",{className:"text-lx md:text-md text-n-200 font-normal",children:"There are no messages in this wallet"})]})})},J=function(e){var n=e.onConnect,t=e.filter,r=e.followings,s=(0,Z.Z)().walletAddress;return(0,j.jsx)("div",{className:"flex-grow flex flex-col",children:s?(0,j.jsx)(Q,{filter:t,walletAddress:s,followings:r}):(0,j.jsx)(B,{children:(0,j.jsx)(G,{onConnect:n})})})},Y="1.0.0",ee=t(51183),ne=t(4564),te=t(93481),re=t(18302),se=function(e){var n=e.icon,t=e.headingText,r=e.subHeadingText,s=e.onClick,i=e.disabled;return(0,j.jsx)("a",{onClick:i?void 0:s,className:i?"cursor-auto":"cursor-pointer",children:(0,j.jsxs)("div",{className:(0,H.AK)(i?"opacity-40":"","flex py-4 border border-x-0 border-y-zinc-50 justify-between items-stretch text-left"),children:[(0,j.jsx)("div",{className:"h-10 w-10 bg-l-300 rounded-lg text-white p-2",children:n}),(0,j.jsxs)("div",{className:"ml-3 flex-col justify-center text-md flex-1",children:[(0,j.jsx)("div",{className:"font-semibold text-n-600",children:t}),(0,j.jsx)("div",{className:"text-n-300",children:r})]}),(0,j.jsx)("div",{className:"w-10 flex justify-end items-center pr-2",children:(0,j.jsx)(ee.Z,{className:"h-5"})})]})})},ie=function(e){var n=e.onConnect,t=(0,Z.Z)(),r=t.walletAddress,s=t.client,i=[{icon:(0,j.jsx)(ne.Z,{}),headingText:"Connect your wallet",subHeadingText:"Verify your wallet to start using the XMTP protocol",onClick:n,disabled:!!r&&!s},{icon:(0,j.jsx)(te.Z,{}),headingText:"Read the docs",subHeadingText:"Check out the documentation for our protocol and find out how to get up and running quickly",onClick:function(){return window.open("https://docs.xmtp.org","_blank")}},{icon:(0,j.jsx)(re.Z,{}),headingText:"Join our community",subHeadingText:"Talk about what you\u2019re building or find out other projects that are building upon XMTP",onClick:function(){return window.open("https://community.xmtp.org","_blank")}}];return(0,j.jsxs)("div",{className:"hidden md:block m-auto w-[464px]",children:[(0,j.jsxs)("div",{className:"pb-6",children:[(0,j.jsx)("div",{className:"text-xl text-n-600 font-semibold mb-1",children:"Welcome to the web3 communication protocol"}),(0,j.jsx)("div",{className:"text-md text-n-300",children:"Get started by reading the docs or joining the community"})]}),(0,j.jsx)("div",{children:i.map((function(e,n){return(0,j.jsx)(se,{icon:e.icon,headingText:e.headingText,subHeadingText:e.subHeadingText,onClick:e.onClick,disabled:e.disabled},n)}))}),(0,j.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,j.jsxs)("div",{className:"text-n-600 text-sm",children:["v",Y]}),(0,j.jsxs)("a",{href:"https://blog.xmtp.com/contact/",target:"_blank",className:"text-l-300 font-semibold text-md flex items-center",rel:"noreferrer",children:["I need help ",(0,j.jsx)(_.Z,{className:"h-5 fill-l-300"})]})]})]})},ae=t(22659),ce=t(30710),oe=function(e){var n=e.walletAddress;return(0,j.jsx)(ce.Z,{seed:n,size:8,className:"rounded-full mr-2"})},le=function(e){var n=e.onConnect;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)("div",{children:[(0,j.jsxs)("div",{className:"flex items-center",children:[(0,j.jsx)("div",{className:"bg-y-100 rounded-full h-2 w-2 mr-1"}),(0,j.jsx)("p",{className:"text-sm font-bold text-y-100",children:"You are not connected."})]}),(0,j.jsx)("a",{onClick:n,children:(0,j.jsx)("p",{className:"text-sm font-normal text-y-100 hover:text-y-200 ml-3 cursor-pointer",children:"Sign in with your wallet"})})]}),(0,j.jsxs)("button",{className:"max-w-xs flex items-center text-sm rounded focus:outline-none",onClick:n,children:[(0,j.jsx)("span",{className:"sr-only",children:"Connect"}),(0,j.jsx)(ae.Z,{className:"h-6 w-6 md:h-5 md:w-5 fill-n-100 hover:fill-n-200","aria-hidden":"true"})]})]})},de=function(e){var n=e.onConnect,t=e.onDisconnect,r=(0,Z.Z)(),s=r.walletAddress,i=r.client,a=(0,S.Z)().lookupAddress,c=(0,l.useCallback)((function(){s&&navigator.clipboard.writeText(s)}),[s]);return(0,j.jsx)("div",{className:"flex bg-n-500 items-center justify-between rounded-lg h-14 m-4 mb-5 md:mb-4 px-4 drop-shadow-xl",children:s?(0,j.jsx)(E.v2,{children:function(e){var n=e.open;return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)("div",{className:(0,H.AK)(n?"opacity-75":"","flex items-center"),children:i?(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(oe,{walletAddress:s}),(0,j.jsxs)("div",{className:"flex flex-col",children:[(0,j.jsxs)("div",{className:"flex items-center",children:[(0,j.jsx)("div",{className:"bg-g-100 rounded h-2 w-2 mr-1"}),(0,j.jsx)("p",{className:"text-sm font-bold text-g-100",children:"Connected as:"})]}),(0,j.jsx)(K.Z,{address:s,className:"text-md leading-4 font-semibold text-white ml-3",lookupAddress:a})]})]}):(0,j.jsxs)("div",{className:"h-14 flex flex-col flex-1 justify-center",children:[(0,j.jsxs)("div",{className:"flex items-center",children:[(0,j.jsx)("div",{className:"bg-p-100 rounded h-2 w-2 mr-1"}),(0,j.jsx)("p",{className:"text-sm font-bold text-p-100",children:"Connecting..."})]}),(0,j.jsx)("p",{className:"text-sm font-normal text-p-100 ml-3",children:"Verifying your wallet"})]})}),(0,j.jsx)("div",{children:(0,j.jsxs)(E.v2.Button,{className:"max-w-xs flex items-center text-sm rounded-full focus:outline-none",children:[(0,j.jsx)("span",{className:"sr-only",children:"Open user menu"}),(0,j.jsx)(ae.Z,{className:(0,H.AK)(n?"fill-white":"","h-6 w-6 md:h-5 md:w-5 fill-n-100 hover:fill-n-200"),"aria-hidden":"true"})]})}),(0,j.jsx)(E.uT,{as:l.Fragment,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:(0,j.jsxs)(E.v2.Items,{className:"origin-bottom-right absolute right-0 bottom-12 mb-4 w-40 rounded-md shadow-lg bg-white divide-y-2 divide-zinc-50 ring-1 ring-black ring-opacity-5 focus:outline-none",children:[(0,j.jsx)("div",{className:"px-1 py-1 ",children:(0,j.jsx)(E.v2.Item,{children:function(e){var n=e.active;return(0,j.jsx)("a",{onClick:c,className:(0,H.AK)(n?"bg-zinc-50":"","block rounded-md px-2 py-2 text-sm text-n-600 text-right font-normal cursor-pointer"),children:"Copy wallet address"})}})}),(0,j.jsx)("div",{className:"px-1 py-1 ",children:(0,j.jsx)(E.v2.Item,{children:function(e){var n=e.active;return(0,j.jsx)("a",{onClick:t,className:(0,H.AK)(n?"bg-zinc-50 cursor-pointer":"","block rounded-md px-2 py-2 text-sm text-l-300 text-right font-semibold"),children:"Disconnect wallet"})}})})]})})]})}}):(0,j.jsx)(le,{onConnect:n})})},ue=t(68121),fe=function(e){var n=e.onClick;return(0,j.jsxs)("button",{type:"button",className:"flex items-center justify-center h-10 w-6 rounded-full focus:outline-none focus:ring-2 focus:ring-inset focus:ring-white",onClick:n,children:[(0,j.jsx)("span",{className:"sr-only",children:"Close message view"}),(0,j.jsx)(ue.Z,{className:"h-5 w-5 stroke-n-600","aria-hidden":"true"})]})},xe=function(e){var n=e.filter,t=e.setFilter;return(0,j.jsx)("button",{className:"inline-flex items-center h-7 md:h-6 px-4 py-1 my-4 bg-p-400 border border-p-300 hover:bg-p-300 focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-n-100 focus-visible:ring-offset-p-600 focus-visible:border-n-100 focus-visible:outline-none active:bg-p-500 active:border-p-500 active:ring-0 text-sm md:text-xs md:font-semibold tracking-wide text-white rounded",onClick:function(){switch(n){case p.w.All:t(p.w.Connected);break;case p.w.Connected:t(p.w.Invites);break;case p.w.Invites:t(p.w.All)}},children:n===p.w.Connected?"Connections only":n===p.w.All?"All peers":"Invites"})},me=function(e){var n=e.children;return(0,j.jsx)("aside",{className:"flex w-full md:w-84 flex-col flex-grow fixed inset-y-0",children:(0,j.jsx)("div",{className:"flex flex-col flex-grow md:border-r md:border-gray-200 bg-white overflow-y-auto",children:n})})},he=function(e){var n=e.children;return(0,j.jsxs)("div",{className:"h-14 bg-p-600 flex items-center justify-between flex-shrink-0 px-4",children:[(0,j.jsx)(P.default,{href:"/",passHref:!0,children:(0,j.jsx)("img",{className:"h-8 w-auto",src:"/xmtp-icon.png",alt:"XMTP"})}),n]})},pe=function(e){var n=e.children;return(0,j.jsx)("div",{className:"sticky top-0 z-10 flex-shrink-0 flex bg-zinc-50 border-b border-gray-200 md:bg-white md:border-0",children:n})},ve=function(e){var n=e.children,t=(0,O.useRouter)(),r=t.query.recipientWalletAddr,i=(0,l.useCallback)(function(){var e=(0,s.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.push(n?"/dm/".concat(n):"/dm/");case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[t]),a=(0,l.useCallback)((function(){t.push("/")}),[t]);return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(pe,{children:[(0,j.jsx)("div",{className:"md:hidden flex items-center ml-3",children:(0,j.jsx)(fe,{onClick:a})}),(0,j.jsx)(I.PG,{recipientWalletAddress:r||"",onSubmit:i})]}),n]})},be=function(e){var n=e.children,t=(0,Z.Z)(),r=t.connect,i=t.disconnect,a=t.walletAddress,c=t.client,d=t.followings,u=(0,O.useRouter)(),f=(0,S.Z)(),x=f.signer,m=f.connect,h=f.disconnect,v=(0,l.useCallback)((0,s.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(),e.next=3,h();case 3:u.push("/");case 4:case"end":return e.stop()}}),e)}))),[h,i,u]),b=(0,l.useCallback)((0,s.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m();case 2:case"end":return e.stop()}}),e)}))),[m]),g=function(e){var n=(0,l.useRef)();return(0,l.useEffect)((function(){n.current=e})),n.current}(x),w=(0,l.useState)(p.w.Connected),k=w[0],y=w[1];return(0,l.useEffect)((function(){(!x&&g&&i(),x&&x!==g)&&function(){var e=(0,s.Z)(o().mark((function e(){var n;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===g||void 0===g?void 0:g.getAddress();case 2:return n=e.sent,e.next=5,x.getAddress();case 5:if(e.sent!==n){e.next=8;break}return e.abrupt("return");case 8:r(x);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[x,g,r,i]),(0,j.jsxs)(j.Fragment,{children:[(0,j.jsxs)(T.default,{children:[(0,j.jsx)("title",{children:"Chat via XMTP"}),(0,j.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1, maximum-scale=1"})]}),(0,j.jsxs)("div",{children:[(0,j.jsx)(M,{children:(0,j.jsxs)(me,{children:[(0,j.jsxs)(he,{children:[a&&c&&(0,j.jsx)(xe,{filter:k,setFilter:y}),a&&c&&(0,j.jsx)(D,{})]}),(0,j.jsx)(J,{onConnect:b,filter:k,followings:d}),(0,j.jsx)(de,{onConnect:b,onDisconnect:v})]})}),(0,j.jsx)(F,{children:a&&c?(0,j.jsx)(ve,{children:n}):(0,j.jsx)(ie,{onConnect:b})})]})]})},ge=t(98036),we=t(42484),je=t.n(we),ke=t(64488),ye=t(80983),Ne=t(23963),Ce=t(34155),Ae=new Map,Ze=new Map,Oe=function(e){var n=e.children,t=(0,l.useState)(),r=t[0],i=t[1],a=(0,l.useState)(),c=a[0],d=a[1],u=(0,l.useState)(),f=u[0],x=u[1],m=(0,l.useState)(),h=m[0],p=m[1],v=(0,l.useCallback)(function(){var e=(0,s.Z)(o().mark((function e(n){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ze.has(n)){e.next=2;break}return e.abrupt("return",Ze.get(n));case 2:return e.next=4,null===r||void 0===r?void 0:r.resolveName(n);case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=void 0;case 7:return t=e.t0,Ze.set(n,t),e.abrupt("return",t);case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[r]),b=(0,l.useCallback)(function(){var e=(0,s.Z)(o().mark((function e(n){var t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Ae.has(n)){e.next=2;break}return e.abrupt("return",Ae.get(n));case 2:return e.next=4,null===r||void 0===r?void 0:r.lookupAddress(n);case 4:if(e.t0=e.sent,e.t0){e.next=7;break}e.t0=void 0;case 7:return t=e.t0,Ae.set(n,t),e.abrupt("return",t);case 10:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[r]),g=(0,l.useCallback)((0,s.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f){e.next=2;break}return e.abrupt("return");case 2:f.clearCachedProvider(),localStorage.removeItem("walletconnect"),Object.keys(localStorage).forEach((function(e){e.startsWith("-walletlink")&&localStorage.removeItem(e)})),d(void 0);case 6:case"end":return e.stop()}}),e)}))),[f]),w=(0,l.useCallback)(function(){var e=(0,s.Z)(o().mark((function e(n){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(h&&n.indexOf(h)<0)){e.next=3;break}return e.next=3,g();case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),[h,g]),k=(0,l.useCallback)((0,s.Z)(o().mark((function e(){var n,t,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(f){e.next=2;break}throw new Error("web3Modal not initialized");case 2:return e.prev=2,e.next=5,f.connect();case 5:if(n=e.sent){e.next=8;break}return e.abrupt("return");case 8:return n.on("accountsChanged",w),t=new ge.Q(n),r=t.getSigner(),d(r),e.t0=p,e.next=15,r.getAddress();case 15:return e.t1=e.sent,(0,e.t0)(e.t1),e.abrupt("return",r);case 20:e.prev=20,e.t2=e.catch(2),console.log("error",e.t2);case 23:case"end":return e.stop()}}),e,null,[[2,20]])}))),[f,w]);return(0,l.useEffect)((function(){var e=Ce.env.NEXT_PUBLIC_INFURA_ID||"b6058e03f2cd4108ac890d3876a56d0d",n={walletconnect:{package:ke.Z,options:{infuraId:e}}};(!window.ethereum||window.ethereum&&!window.ethereum.isCoinbaseWallet)&&(n.walletlink={package:ye.ZP,options:{appName:"Chat via XMTP",infuraId:e}}),window.ethereum&&window.ethereum.isMetaMask||(n["custom-metamask"]={display:{logo:we.providers.METAMASK.logo,name:"Install MetaMask",description:"Connect using browser wallet"},package:{},connector:function(){var e=(0,s.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:window.open("https://metamask.io");case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}),x(new(je())({cacheProvider:!0,providerOptions:n}))}),[]),(0,l.useEffect)((function(){f&&function(){var e=(0,s.Z)(o().mark((function e(){var n,t,r,s,a;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=localStorage.getItem("WEB3_CONNECT_CACHED_PROVIDER")){e.next=3;break}return e.abrupt("return");case 3:return t=JSON.parse(n),e.next=6,f.connectTo(t);case 6:if(r=e.sent){e.next=9;break}return e.abrupt("return");case 9:return r.on("accountsChanged",w),s=new ge.Q(r),a=s.getSigner(),i(s),d(a),e.t0=p,e.next=17,a.getAddress();case 17:e.t1=e.sent,(0,e.t0)(e.t1);case 19:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[f,w]),(0,j.jsx)(Ne.z.Provider,{value:{provider:r,signer:c,address:h,web3Modal:f,resolveName:v,lookupAddress:b,connect:k,disconnect:g},children:n})};var Te=function(e){var n=e.children;return(0,j.jsx)(Oe,{children:(0,j.jsx)(A,{children:(0,j.jsx)(be,{children:n})})})}},88677:function(){},62808:function(){},43094:function(){},95856:function(){},69159:function(){},35883:function(){},46601:function(){},89214:function(){},5696:function(){},85568:function(){},45443:function(){},89408:function(){},47956:function(){},21724:function(){},62678:function(){},25819:function(){},24112:function(){},63818:function(){},52361:function(){},94616:function(){},6567:function(){},42602:function(){}}]);